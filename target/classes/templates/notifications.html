<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>通知</title>
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/notification.css}">
</head>
<body>
    <div class="home-container">
        <div class="notification-container">
            <!-- ヘッダー -->
            <div class="header">
                <h1 class="page-title">通知</h1>
                <div class="header-actions">
                    <button id="markAllReadBtn" class="mark-all-read-btn">全て既読</button>
                    <a href="/notifications/history" class="history-btn">履歴</a>
                </div>
            </div>
            
            <div class="main-content">
                <!-- 新着通知セクション -->
                <div th:if="${!newNotifications.empty}" class="notification-section">
                    <h2 class="section-title">新着通知</h2>
                    <div class="notification-list">
                        <div th:each="notification : ${newNotifications}" 
                             th:class="${notification.isRead ? 'notification-item' : 'notification-item unread'}"
                             th:attr="data-notification-id=${notification.notificationId}"
                             class="notification-item">
                            
                            <div class="notification-header-row">
                                <div class="notification-info">
                                    <h3 class="notification-title-text" th:text="${notification.title}">通知タイトル</h3>
                                    <span class="notification-time" th:text="${#temporals.format(notification.createdAt, 'MM/dd HH:mm')}">12/25 10:30</span>
                                </div>
                                <span th:if="${notification.notificationType != null}" 
                                      th:class="${'notification-type-badge ' + notification.notificationType}" 
                                      th:text="${getNotificationTypeLabel(notification.notificationType)}">通知種別</span>
                            </div>
                            
                            <p class="notification-message" th:text="${notification.message}">通知メッセージ</p>
                            
                            <!-- 通知種別に応じたアクションボタン -->
                            <div th:if="${notification.notificationType == 'workout_completed'}" class="notification-actions">
                                <button class="action-btn view-workout-btn" th:attr="data-workout-id=${notification.relatedData}">
                                    運動詳細を見る
                                </button>
                            </div>
                            
                            <div th:if="${notification.notificationType == 'buddy_request'}" class="notification-actions">
                                <button class="action-btn accept-buddy-btn" th:attr="data-requester-id=${notification.fromUserId}">
                                    承認する
                                </button>
                                <button class="action-btn reject-buddy-btn" th:attr="data-requester-id=${notification.fromUserId}">
                                    拒否する
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 過去の通知セクション -->
                <div th:if="${!notifications.empty}" class="notification-section">
                    <h2 class="section-title">過去の通知</h2>
                    <div class="notification-list">
                        <div th:each="notification : ${notifications}" 
                             th:class="${notification.isRead ? 'notification-item' : 'notification-item unread'}"
                             th:attr="data-notification-id=${notification.notificationId}"
                             class="notification-item">
                            
                            <div class="notification-header-row">
                                <div class="notification-info">
                                    <h3 class="notification-title-text" th:text="${notification.title}">通知タイトル</h3>
                                    <span class="notification-time" th:text="${#temporals.format(notification.createdAt, 'MM/dd HH:mm')}">12/25 10:30</span>
                                </div>
                                <span th:if="${notification.notificationType != null}" 
                                      th:class="${'notification-type-badge ' + notification.notificationType}" 
                                      th:text="${getNotificationTypeLabel(notification.notificationType)}">通知種別</span>
                            </div>
                            
                            <p class="notification-message" th:text="${notification.message}">通知メッセージ</p>
                        </div>
                    </div>
                </div>
                
                <!-- 通知がない場合 -->
                <div th:if="${notifications.empty && newNotifications.empty}" class="empty-notifications">
                    <p>通知はありません</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ボトムナビゲーション -->
    <nav class="bottom-nav">
        <div class="nav-container">
            <a href="/" class="nav-item">
                <span class="nav-icon">🏠</span>
                <span class="nav-label">ホーム</span>
            </a>
            <a href="/buddy/search" class="nav-item">
                <span class="nav-icon">👥</span>
                <span class="nav-label">バディ追加</span>
            </a>
            <div class="nav-item center-action">
                <form th:action="@{/workout/start-with-goal}" method="post" style="display: inline;">
                    <button type="submit" class="nav-center-btn">
                        <span class="center-icon">🏃</span>
                    </button>
                </form>
                <span class="nav-label">運動を始める</span>
            </div>
            <a href="/workout/records" class="nav-item">
                <span class="nav-icon">📊</span>
                <span class="nav-label">私の記録</span>
            </a>
            <a href="/goal/set" class="nav-item">
                <span class="nav-icon">📋</span>
                <span class="nav-label">目標設定</span>
            </a>
        </div>
    </nav>
    
    <script th:src="@{/js/notification.js}"></script>
</body>
</html> 